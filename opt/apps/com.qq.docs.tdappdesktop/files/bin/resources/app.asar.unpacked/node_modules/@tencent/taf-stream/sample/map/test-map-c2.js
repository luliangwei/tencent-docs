var Taf = require("../../libjce");

var map = new Taf.Map(Taf.String, Taf.Map(Taf.String, Taf.BinBuffer));
for (var i = 0; i < 10; i++) {
    var m = new Taf.Map(Taf.String, Taf.BinBuffer);
    var key
    for (var ii = 0; ii < 2; ii++) {
        key = "KEY-" + i.toString() + "-" + ii.toString();
        var val = new Taf.BinBuffer();
        val.writeInt32(i * 100 + ii);

        m.insert(key, val);
    }

    key = "KEY-" + i.toString();
    map.insert(key, m);
}

var ost = new Taf.JceOutputStream();
ost.writeMap(0, map);

var ist = new Taf.JceInputStream(ost.getBinBuffer());
var tmp = ist.readMap(0, true, Taf.Map(Taf.String, Taf.Map(Taf.String, Taf.BinBuffer)));
tmp.forEach(function (key, value){
    console.log(key,"==============================");
    value.forEach(function (key, value){
        console.log("    ", key, value.readInt32());
    });
});
