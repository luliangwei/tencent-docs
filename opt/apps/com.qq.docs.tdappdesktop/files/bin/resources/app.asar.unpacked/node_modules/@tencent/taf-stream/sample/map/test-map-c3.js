var Taf = require("../../libjce");
var Ext = require("../jce/ExtJce.js").Ext;

var map = new Taf.Map(Taf.String, Taf.Map(Taf.String, Ext.ExtInfo));

for (var i = 0; i < 10; i++) {
   var m = new Taf.Map(Taf.String, Ext.ExtInfo);
   var key;
   for (var ii = 0; ii < 2; ii++) {
      key = "KEY-" + i.toString() + "-" + ii.toString();
      var val = new Ext.ExtInfo();
      val.sUserName = "VAL-" + ii.toString();

      m.insert(key, val);
   }

   key = "KEY-" + i.toString();
   map.insert(key, m);
}

var ost = new Taf.JceOutputStream();
ost.writeMap(0, map);

var ist = new Taf.JceInputStream(ost.getBinBuffer());
var tmp = ist.readMap(0, true, Taf.Map(Taf.String, Taf.Map(Taf.String, Ext.ExtInfo)));
tmp.forEach(function (key, value){
   value.forEach(function (key, value){
      console.log("    ", key, value.sUserName);
   });
});
